# AI API 統合によるキーワード/キーフレーズ抽出強化

## 概要

既存の TextRank ライブラリベースのキーワード/キーフレーズ抽出システムに AI API を統合し、精度向上とコスト最適化を実現します。

## AI API 選定結果

### コスト効率分析（2025 年 1 月時点）

#### 最優先候補（開発・本番両対応）

1. **Gemini 2.0 Flash** - $0.10/$0.40 per 1M tokens

   - 最高のコスト効率
   - 日本語対応強化
   - レスポンス速度良好

2. **GPT-4o mini** - $0.15/$0.60 per 1M tokens

   - OpenAI 品質保証
   - 日本語技術文書処理に優秀
   - API 安定性高

3. **Claude 3.5 Haiku** - $0.80/$4.00 per 1M tokens
   - バランス型選択肢
   - 高精度な日本語理解
   - コンテキスト理解優秀

#### 超低コスト選択肢（開発用）

- **DeepSeek** - $0.55/$2.19 per 1M tokens
- **Amazon Nova Micro** - $0.035/$0.14 per 1M tokens

### 推奨実装戦略

#### Phase 1: 後処理 AI 改善（最優先実装）

```
TextRank抽出 → AI API後処理 → 最終キーフレーズ
```

**選定 API**: Gemini 2.0 Flash（コスト効率最高）
**想定コスト**: 開発$30-50/月、本番$100-200/月
**処理時間**: +1-2 秒

#### Phase 2: AI 要約前処理（第二段階）

```
AI要約 → TextRank抽出 → 最終キーフレーズ
```

**選定 API**: GPT-4o mini（要約品質重視）
**想定コスト**: 開発$50-80/月、本番$150-300/月

## 実装アーキテクチャ

### 1. AI API 統合レイヤー

- API 呼び出し管理
- レート制限対応
- エラーハンドリング
- レスポンスキャッシュ

### 2. 後処理 AI 改善パイプライン

```typescript
// 既存TextRank結果の改善
aiEnhancedExtraction(textRankResults, originalText) {
  // AI APIによる関連性評価
  // 重複除去・統合
  // 品質スコアリング
  // 最適化されたキーフレーズ返却
}
```

### 3. 段階的フォールバック

- AI API 失敗時は TextRank 結果を返却
- レート制限時はキャッシュ利用
- 緊急時は従来手法維持

## コスト予測（月額）

### 開発環境

- 1 日 100 イベント処理 × 30 日 = 3,000 リクエスト
- 平均 1,000 トークン/イベント
- **Gemini 2.0**: $0.30-1.20/月
- **GPT-4o mini**: $0.45-1.80/月

### 本番環境

- 1 日 1,000 イベント処理 × 30 日 = 30,000 リクエスト
- 平均 1,000 トークン/イベント
- **Gemini 2.0**: $3-12/月
- **GPT-4o mini**: $4.5-18/月

## 実装優先順位

### 高優先度（1-2 週間）

1. ✅ AI API 選定完了（Gemini 2.0 Flash）
2. 🔄 後処理 AI 改善実装
3. 🔄 基本統合テスト

### 中優先度（3-4 週間）

1. AI 要約前処理実装
2. パフォーマンス最適化
3. コスト監視システム

### 低優先度（5-8 週間）

1. 複数 API 並列処理
2. A/B テスト実装
3. 高度なキャッシュ戦略

## 品質指標

### 目標メトリクス

- キーフレーズ平均長: <20 文字
- 技術用語カバー率: 80%+
- 処理時間: <5 秒
- コスト/イベント: <$0.01

### 評価方法

- 既存 TextRank vs AI 強化版の比較
- 手動評価による精度検証
- コスト効率分析
- レスポンス時間測定

## 技術的考慮事項

### セキュリティ

- API キー環境変数管理
- リクエストデータの暗号化
- ログ出力の機密情報除外

### 拡張性

- 複数 AI provider 対応設計
- 動的 API 切り替え機能
- 設定ベースの調整機能

### 監視・運用

- API 呼び出し回数追跡
- エラー率監視
- コスト使用量アラート

## 次のアクション

1. **immediate**: Gemini 2.0 Flash API 統合実装
2. **1 週間以内**: 後処理 AI 改善機能完成
3. **2 週間以内**: 統合テストと性能評価
4. **1 ヶ月以内**: Phase 2 実装検討

---

_最終更新: 2025 年 1 月_
_実装担当: AI Assistant_
_承認待ち: Phase 1 実装開始_
